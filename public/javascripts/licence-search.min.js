"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),(()=>{const e=document.querySelector("main").dataset.urlPrefix,t=exports.licenceAlias,s=exports.licenceAliasPlural,a=exports.licenseeAlias,n=document.querySelector("#form--filters"),i=document.querySelector("#filter--limit"),r=document.querySelector("#filter--offset"),c=document.querySelector("#container--searchResults"),l=()=>{const o=Number.parseInt(i.value,10),d=Number.parseInt(r.value,10);c.innerHTML='<p class="has-text-centered has-text-grey-lighter"><i class="fas fa-3x fa-circle-notch fa-spin" aria-hidden="true"></i><br /><em>Loading records...</em></p>',cityssm.postJSON(e+"/licences/doSearch",n,n=>{const i=n.licences;if(0===i.length)return void(c.innerHTML='<div class="message is-info"><div class="message-body"><strong>Your search returned no results.</strong><br />Please try expanding your search criteria.</div></div>');c.innerHTML='<table class="table is-fullwidth is-striped is-hoverable has-sticky-header"><thead><tr><th>'+t+" Number</th><th>Category</th><th>"+a+'</th><th>Effective Start</th><th>Effective End</th><th class="has-text-centered">Status</th><th class="is-hidden-print"></th></tr></thead></table>';const u=document.createElement("tbody");for(const t of i){const s=document.createElement("tr");let a=cityssm.escapeHTML(t.licenseeName);""!==t.licenseeBusinessName.trim()&&(a=cityssm.escapeHTML(t.licenseeBusinessName)+'<br /><span class="is-size-7">'+a+"</span>"),s.innerHTML='<td><a href="'+e+"/licences/"+t.licenceId.toString()+'">'+cityssm.escapeHTML(t.licenceNumber)+"</a></td><td>"+cityssm.escapeHTML(t.licenceCategory)+"</td><td>"+a+"</td><td>"+t.startDateString+"</td><td>"+t.endDateString+'</td><td class="has-text-centered">'+(t.issueDate?'<span class="tag is-success">Issued</span>':'<span class="tag is-warning">Pending</span>')+'</td><td class="is-hidden-print has-text-right">'+(t.issueDate?'<a class="button is-small" href="'+e+"/licences/"+t.licenceId+'/print" target="_blank" download><i class="fas fa-print" aria-label="Print"></i></a>':"")+"</td>",u.append(s)}if(c.querySelector("table").append(u),c.insertAdjacentHTML("beforeend",'<div class="level is-block-print"><div class="level-left has-text-weight-bold">Displaying '+s+" "+(d+1).toString()+" to "+Math.min(o+d,n.count).toString()+" of "+n.count.toString()+"</div></div>"),o<n.count){const e=document.createElement("nav");if(e.className="level-right is-hidden-print",e.setAttribute("role","pagination"),e.setAttribute("aria-label","pagination"),d>0){const t=document.createElement("a");t.className="button",t.textContent="Previous",t.addEventListener("click",e=>{e.preventDefault(),r.value=Math.max(0,d-o).toString(),l()}),e.append(t)}if(o+d<n.count){const t=document.createElement("a");t.className="button ml-3",t.innerHTML="<span>Next "+s+'</span><span class="icon"><i class="fas fa-chevron-right" aria-hidden="true"></i></span>',t.addEventListener("click",e=>{e.preventDefault(),r.value=(d+o).toString(),l()}),e.append(t)}c.querySelector(".level").append(e)}})},o=()=>{r.value="0",l()};n.addEventListener("submit",e=>{e.preventDefault()});const d=n.querySelectorAll(".input, .select select");for(const e of d)e.addEventListener("change",o);o()})();