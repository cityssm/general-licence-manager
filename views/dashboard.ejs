<%- include('_header'); -%>

<div class="level">
  <div class="level-left has-flex-shrink-1">
    <h1 class="title is-1">
      <%= configFunctions.getProperty("application.applicationName") %>
    </h1>
  </div>
</div>

<% if (licenceCategories.length === 0) { %>
  <div class="message is-warning">
    <p class="message-body">
      <strong>There are no active <%= configFunctions.getProperty("settings.licenceAlias").toLowerCase() %> categories available.</strong>
    </p>
  </div>
<% } %>

<div class="columns">
  <div class="column">
    <div class="card">
      <div class="card-content">
        <div class="media">
          <div class="media-left" aria-hidden="true">
            <i class="fas fa-3x fa-fw fa-certificate"></i>
          </div>
          <div class="media-content has-text-black">
            <% let uid = "uid--" + stringFns.getUID(); %>
            <h2 class="title is-4 is-marginless">
              <a href="<%= urlPrefix %>/licences" aria-describedby="<%= uid %>">
              <%= configFunctions.getProperty("settings.licenceAliasPlural") %></a>
            </h2>
            <p id="<%= uid %>">View and maintain <%= configFunctions.getProperty("settings.licenceAliasPlural").toLowerCase() %>.</p>
          </div>
        </div>
        <% if (user.userProperties.canUpdate) { %>
          <div class="media">
            <div class="media-left" aria-hidden="true">
              <span class="fa-layers fa-fw fa-3x">
                <i class="fas fa-certificate"></i>
                <i class="fas fa-plus has-text-success" data-fa-glow data-fa-transform="shrink-8 down-5 right-6"></i>
              </span>
            </div>
            <div class="media-content has-text-black">
              <h2 class="title is-4 is-marginless">
                <a href="<%= urlPrefix %>/licences/new">Create a New <%= configFunctions.getProperty("settings.licenceAlias") %></a>
              </h2>
            </div>
          </div>
        <% } %>
      </div>
    </div>
    <% if (configFunctions.getProperty("settings.includeBatches") && user.userProperties.canUpdate) { %>
      <div class="card mt-5">
        <div class="card-content">
          <div class="media">
            <div class="media-left" aria-hidden="true">
              <span class="fa-layers fa-fw fa-3x">
                <i class="fas fa-receipt"></i>
                <i class="fas fa-pencil-alt has-text-info" data-fa-glow data-fa-transform="shrink-6 down-4 right-4"></i>
              </span>
            </div>
            <div class="media-content has-text-black">
              <% let uid = "uid--" + stringFns.getUID(); %>
              <h2 class="title is-4 is-marginless">
                <a href="<%= urlPrefix %>/batches/builder" aria-describedby="<%= uid %>">Transaction Batch Builder</a>
              </h2>
              <p id="<%= uid %>">Build batches of transactions for later processing.</p>
            </div>
          </div>
          <% for (const batch of batches) { %>
            <div class="media">
              <div class="media-left" aria-hidden="true">
                <i class="fas fa-fw fa-3x fa-receipt"></i>
              </div>
              <div class="media-content">
                <strong>Batch <%= batch.batchDateString %></strong><br />
                <%= batch.transactionCount %> outstanding <%= batch.transactionCount === 1 ? "transaction" : "transactions" %><br />
                <span class="is-size-7">Last Updated <%= batch.recordUpdate_dateString %></span>
              </div>
              <div class="media-right">
                <a class="button is-link is-light" data-tooltip="Download Batch" href="<%= urlPrefix %>/batches/export/<%= batch.batchDate %>" aria-label="Download Batch" download>
                  <i class="fa fa-download" aria-hidden="true"></i>
                </a>
                <a class="button is-success is-light" data-tooltip="Reconcile Batch" href="<%= urlPrefix %>/batches/reconcile/<%= batch.batchDate %>" aria-label="Download Batch">
                  <i class="fa fa-check" aria-hidden="true"></i>
                </a>
              </div>
            </div>
          <% } %>
        </div>
      </div>
    <% } %>
  </div>
  <div class="column">
    <div class="card">
      <div class="card-content">
        <div class="media">
          <div class="media-left" aria-hidden="true">
            <i class="fas fa-3x fa-fw fa-file"></i>
          </div>
          <div class="media-content has-text-black">
            <% uid = "uid--" + stringFns.getUID(); %>
            <h2 class="title is-4 is-marginless">
              <a href="<%= urlPrefix %>/reports" aria-describedby="<%= uid %>">Report Library</a>
            </h2>
            <p id="<%= uid %>">Produce reports and export data.</p>
          </div>
        </div>
      </div>
    </div>
    <% if (user.userProperties.isAdmin) { %>
      <div class="card mt-5">
        <div class="card-content">
          <div class="media">
            <div class="media-left" aria-hidden="true">
              <i class="fas fa-3x fa-fw fa-cogs"></i>
            </div>
            <div class="media-content has-text-black">
              <% uid = "uid--" + stringFns.getUID(); %>
              <h2 class="title is-4 is-marginless">
                <a href="<%= urlPrefix %>/admin/licenceCategories" aria-describedby="<%= uid %>">
                  <%= configFunctions.getProperty("settings.licenceAlias") %> Categories
                </a>
              </h2>
              <p id="<%= uid %>">
                Add new <%= configFunctions.getProperty("settings.licenceAlias").toLowerCase() %> types.
                Maintain existing <%= configFunctions.getProperty("settings.licenceAlias").toLowerCase() %> types.
              </p>
            </div>
          </div>
        </div>
      </div>
    <% } %>
    <div class="card mt-5">
      <div class="card-content">
        <div class="media">
          <div class="media-left" aria-hidden="true">
            <i class="fas fa-3x fa-fw fa-question-circle"></i>
          </div>
          <div class="media-content has-text-black">
            <% uid = "uid--" + stringFns.getUID(); %>
            <h2 class="title is-4 is-marginless">
              <a href="https://cityssm.github.io/general-licence-manager/docs" target="_blank" rel="noopener noreferrer" aria-describedby="<%= uid %>">Help Documentation</a>
            </h2>
            <p id="<%= uid %>">Instructions on how to use this application.</p>
          </div>
        </div>
        <div class="media">
          <div class="media-left" aria-hidden="true">
            <i class="fab fa-3x fa-fw fa-github"></i>
          </div>
          <div class="media-content has-text-black">
            <% uid = "uid--" + stringFns.getUID(); %>
            <h2 class="title is-4 is-marginless">
              <a href="https://github.com/cityssm/general-licence-manager" target="_blank" rel="noopener noreferrer" aria-describedby="<%= uid %>">
                GitHub
              </a>
            </h2>
            <p id="<%= uid %>">Latest Updates, Issue Tracker, Say Hello.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('_footerA'); -%>
<%- include('_footerB'); -%>
